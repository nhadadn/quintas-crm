var o=o=>{console.log("✅ Endpoint /amortizacion registrado correctamente"),o.post("/generar",(o,t)=>{try{const{monto_total:a,enganche:e,plazo_meses:s,tasa_interes:n,fecha_inicio:r}=o.body;if(void 0===a||void 0===s)return t.status(400).json({errors:[{message:"Faltan campos obligatorios: monto_total, plazo_meses"}]});const i=parseFloat(a)-parseFloat(e||0),l=parseInt(s),c=parseFloat(n||0),p=c/100/12,m=new Date(r||Date.now());let g=0;g=p<=0?i/l:i*(p*Math.pow(1+p,l))/(Math.pow(1+p,l)-1);const _=[];let d=i;for(let o=1;o<=l;o++){const t=d*p;let a=g-t;o===l&&(a=d),d-=a;const e=new Date(m);e.setMonth(m.getMonth()+o),_.push({numero_pago:o,fecha_pago:e.toISOString().split("T")[0],monto_pago:(a+t).toFixed(2),interes:t.toFixed(2),capital:a.toFixed(2),saldo:(d<.01?0:d).toFixed(2)})}t.json({data:{monto_financiar:i,tasa_anual:c,plazo_meses:l,cuota_mensual:g.toFixed(2),tabla_amortizacion:_}})}catch(o){console.error("❌ Error en /amortizacion/generar:",o),t.status(500).json({errors:[{message:o.message}]})}})};export{o as default};
